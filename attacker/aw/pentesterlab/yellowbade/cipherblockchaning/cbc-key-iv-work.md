Chúng ta hãy xem ví dụ cách hoạt động của Key và IV trong mã hóa CBC bằng thuật toán AES (Advanced Encryption Standard).

Giả sử chúng ta có một chuỗi dữ liệu đầu vào là "Hello, World!" và chúng ta muốn mã hóa nó bằng AES-CBC với một Key và một IV.

1. Key: Giả sử chúng ta có một Key là "0123456789abcdef" (16 bytes). Key này sẽ được chia sẻ giữa bên mã hóa và bên giải mã.

2. IV: Giả sử chúng ta có một IV là "fedcba9876543210" (16 bytes). IV này là một giá trị ngẫu nhiên và được sử dụng để khởi tạo quá trình mã hóa.

Các bước của quá trình mã hóa CBC với Key và IV:

1. Chia dữ liệu đầu vào thành các khối dữ liệu có độ dài bằng với khối dữ liệu của thuật toán mã hóa (trong trường hợp AES, là 16 bytes).

2. Khối đầu tiên sẽ được kết hợp với IV thông qua phép XOR:

   Khối đầu vào: "Hello, World!"
   XOR với IV:    "fedcba9876543210"
   -----------------------------
   Kết quả:       "1f1e1d1c1b1a19181716151413121110"

3. Mã hóa kết quả của bước trước đó bằng AES với Key đã cho:

   Khóa: "0123456789abcdef"
   Dữ liệu đầu vào: "1f1e1d1c1b1a19181716151413121110"
   -----------------------------
   Kết quả mã hóa: "a7d9e9a9f2aa1a2c9b4d9c6d9c6c8b6d"

4. Kết quả mã hóa sẽ trở thành khối dữ liệu đầu vào cho khối tiếp theo:

   Khối đầu vào: "Hello, World!"
   XOR với IV:    "fedcba9876543210"
   -----------------------------
   Kết quả:       "1f1e1d1c1b1a19181716151413121110"

5. Quá trình mã hóa và XOR tiếp tục cho các khối dữ liệu tiếp theo cho đến khi tất cả các khối dữ liệu đã được xử lý.

6. Kết quả cuối cùng là chuỗi các khối dữ liệu đã được mã hóa.

Khi giải mã, quá trình tương tự được thực hiện, trong đó Key và IV được sử dụng để giải mã các khối dữ liệu và khôi phục lại dữ liệu gốc.

Lưu ý rằng Key và IV cần được bảo mật và không được tiết lộ cho bất kỳ ai ngoại trừ người được ủy quyền để mã hóa và giải mã dữ liệu.